<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unidad 2 - M√≥dulo 03: Diccionarios en Python</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#003c58',
                        accent: '#06717e',
                        action: '#0055ad',
                        'action-hover': '#399be2',
                        muted: '#f1f5f9',
                        dark: '#0f6cbf',
                        'sky-text': '#6ea2ee',
                        'muted-text': '#6da8e9',
                        'deep-text': '#1e293b',
                        border: '#e2e8f0',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    }
                }
            }
        }
    </script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden;
        }

        .slide {
            display: none;
            height: 100%;
            width: 100%;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .slide.active {
            display: flex;
            opacity: 1;
        }

        /* VS Code Theme */
        .token-keyword {
            color: #c586c0;
        }

        .token-function {
            color: #dcdcaa;
        }

        .token-string {
            color: #ce9178;
        }

        .token-number {
            color: #b5cea8;
        }

        .token-comment {
            color: #6a9955;
            font-style: italic;
        }

        .code-bg {
            background-color: #1e1e1e;
            color: #d4d4d4;
        }

        /* Light Theme VS Code */
        .light-code .token-keyword {
            color: #AF00DB;
        }

        .light-code .token-function {
            color: #795E26;
        }

        .light-code .token-string {
            color: #a31515;
        }

        .light-code .token-number {
            color: #098658;
        }

        .light-code .token-comment {
            color: #008000;
        }

        .light-code {
            background-color: #ffffff;
            color: #000000;
        }

        .mac-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .mac-red {
            background-color: #ff5f56;
        }

        .mac-yellow {
            background-color: #ffbd2e;
        }

        .mac-green {
            background-color: #27c93f;
        }

        /* Tree View */
        .tree-line {
            border-left: 1px dashed #cbd5e1;
            margin-left: 10px;
            padding-left: 20px;
        }
    </style>
</head>

<body class="bg-muted text-deep-text h-screen flex flex-col">

    <!-- Slide 1: Portada -->
    <section id="slide-1" class="slide active items-center justify-center p-12">
        <div class="text-center max-w-4xl animate-[fadeIn_1s_ease-out]">
            <h2 class="text-accent font-bold tracking-[0.2em] uppercase mb-4 text-sm">Unidad 2 - M√≥dulo 03</h2>
            <h1 class="text-6xl font-black text-primary mb-6 leading-tight">Diccionarios en Python</h1>
            <p class="text-2xl text-muted-text font-light mb-12">Estructuras basadas en <span
                    class="font-bold text-action">clave-valor</span></p>
            <div class="h-1 w-24 bg-action mx-auto rounded-full mb-8"></div>
            <p class="text-gray-500 max-w-xl mx-auto">Aprender√°s a crear, modificar, recorrer y organizar datos usando
                diccionarios de manera eficiente.</p>
        </div>
    </section>

    <!-- Slide 2: Definici√≥n -->
    <section id="slide-2" class="slide flex-col p-8 items-center justify-center">
        <div class="max-w-6xl w-full text-center mb-8">
            <h2 class="text-3xl font-bold text-primary mb-6">¬øQu√© es un Diccionario?</h2>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto mb-8">
                Es una estructura que almacena datos en pares <span
                    class="bg-primary/10 text-primary px-2 rounded font-bold">CLAVE</span> - <span
                    class="bg-accent/10 text-accent px-2 rounded font-bold">VALOR</span>.
                La <span class="font-bold text-primary">clave</span> es la etiqueta √∫nica para acceder a la informaci√≥n.
            </p>
        </div>

        <div class="grid grid-cols-2 gap-12 max-w-6xl w-full h-[500px]">
            <!-- Visual Interaction -->
            <div class="bg-white rounded-3xl p-8 border border-border shadow-lg flex flex-col">
                <h3 class="font-bold text-primary mb-6 flex items-center gap-2"><span class="text-2xl">üè∑Ô∏è</span>
                    Constructor Visual</h3>

                <div class="flex gap-4 mb-6">
                    <input id="def-key" type="text" placeholder="Clave (ej: 'nombre')"
                        class="border border-border rounded-lg p-3 w-1/2 focus:ring-2 focus:ring-action outline-none text-sm font-mono">
                    <input id="def-val" type="text" placeholder="Valor (ej: 'Ana')"
                        class="border border-border rounded-lg p-3 w-1/2 focus:ring-2 focus:ring-action outline-none text-sm font-mono">
                </div>
                <button onclick="addToDefinition()"
                    class="bg-action text-white font-bold py-3 rounded-xl hover:bg-action-hover transition-colors mb-6 shadow-md">
                    Agregar Par Clave-Valor
                </button>

                <div id="def-cards-container"
                    class="flex-1 overflow-y-auto space-y-3 p-2 bg-muted/30 rounded-xl relative">
                    <div id="def-empty-state"
                        class="absolute inset-0 flex items-center justify-center text-gray-400 text-sm italic pointer-events-none">
                        Agrega elementos para visualizar...
                    </div>
                </div>
            </div>

            <!-- Code Preview -->
            <div class="flex flex-col">
                <div class="bg-white rounded-t-3xl border border-border border-b-0 p-4 flex gap-2 items-center">
                    <div class="mac-btn mac-red"></div>
                    <div class="mac-btn mac-yellow"></div>
                    <div class="mac-btn mac-green"></div>
                    <span class="ml-4 text-xs font-mono text-gray-400">visualizacion.py</span>
                </div>
                <div
                    class="bg-white border border-border rounded-b-3xl p-6 flex-1 font-mono text-sm light-code shadow-lg relative overflow-hidden">
                    <div id="def-code-display" class="whitespace-pre">persona = {}</div>

                    <div
                        class="absolute bottom-0 left-0 right-0 bg-yellow-50 p-4 border-t border-yellow-100 text-xs text-yellow-800 flex items-start gap-2">
                        <span>üí°</span>
                        <p>El acceso es directo: <code
                                class="bg-yellow-100 px-1 rounded font-bold">persona["clave"]</code>. Si repites la
                            clave, el valor se sobrescribe.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Slide 3: Propiedades -->
    <section id="slide-3" class="slide flex-col p-12 items-center">
        <h2 class="text-4xl font-black text-primary mb-12">Propiedades Fundamentales</h2>

        <div class="grid grid-cols-2 gap-12 w-full max-w-6xl flex-1">
            <!-- Cards List -->
            <div class="flex flex-col gap-4 h-full justify-center">
                <div onclick="showProp(1)"
                    class="prop-card bg-white p-4 rounded-xl border border-border hover:shadow-lg hover:border-action cursor-pointer transition-all group flex items-center gap-4">
                    <div class="text-2xl group-hover:scale-110 transition-transform bg-primary/5 p-2 rounded-lg">üìç
                    </div>
                    <h3 class="font-bold text-primary text-base">No Posicional</h3>
                </div>
                <div onclick="showProp(2)"
                    class="prop-card bg-white p-4 rounded-xl border border-border hover:shadow-lg hover:border-action cursor-pointer transition-all group flex items-center gap-4">
                    <div class="text-2xl group-hover:scale-110 transition-transform bg-primary/5 p-2 rounded-lg">üîë
                    </div>
                    <h3 class="font-bold text-primary text-base">Claves √önicas</h3>
                </div>
                <div onclick="showProp(3)"
                    class="prop-card bg-white p-4 rounded-xl border border-border hover:shadow-lg hover:border-action cursor-pointer transition-all group flex items-center gap-4">
                    <div class="text-2xl group-hover:scale-110 transition-transform bg-primary/5 p-2 rounded-lg">üîÑ
                    </div>
                    <h3 class="font-bold text-primary text-base">Mutable</h3>
                </div>
                <div onclick="showProp(4)"
                    class="prop-card bg-white p-4 rounded-xl border border-border hover:shadow-lg hover:border-action cursor-pointer transition-all group flex items-center gap-4">
                    <div class="text-2xl group-hover:scale-110 transition-transform bg-primary/5 p-2 rounded-lg">üì¶
                    </div>
                    <h3 class="font-bold text-primary text-base">Tipos Admitidos</h3>
                </div>
            </div>

            <!-- Detail View -->
            <div
                class="bg-white rounded-3xl border border-border shadow-2xl p-8 flex flex-col justify-center relative overflow-hidden">
                <div id="prop-detail-content" class="text-center animate-[fadeIn_0.3s_ease-out]">
                    <span class="text-6xl mb-6 block">üëà</span>
                    <h3 class="text-2xl font-bold text-gray-400">Selecciona una propiedad</h3>
                    <p class="text-gray-400 mt-2">Haz clic en las tarjetas de la izquierda para ver los detalles.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Slide 4: Agregar y Acceder -->
    <section id="slide-4" class="slide flex-col p-8 items-center justify-center">
        <div class="max-w-5xl w-full">
            <h2 class="text-3xl font-bold text-primary mb-2">Agregar y Acceder</h2>
            <p class="text-gray-500 mb-8">Usa la consola para manipular el diccionario <code
                    class="bg-muted px-2 py-1 rounded font-bold">persona</code>.</p>

            <div class="grid grid-cols-2 gap-8 h-[500px]">
                <!-- Interactive Console -->
                <div class="bg-[#1e1e1e] rounded-xl p-4 font-mono text-sm text-gray-300 flex flex-col shadow-xl">
                    <div class="flex gap-2 mb-4 border-b border-gray-700 pb-2">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    </div>
                    <div class="flex-1 overflow-y-auto mb-4" id="console-output-4">
                        <div class="text-green-400">>>> persona = {}</div>
                    </div>
                    <div class="flex gap-2 items-center border-t border-gray-700 pt-3">
                        <span class="text-blue-400 font-bold">>>></span>
                        <input id="console-input-4" type="text" class="bg-transparent outline-none flex-1 text-white"
                            placeholder="persona['clave'] = 'valor'" onkeydown="handleConsole4(event)">
                    </div>
                </div>

                <!-- Visual State -->
                <div
                    class="bg-white border-2 border-dashed border-border rounded-xl p-8 flex items-center justify-center relative bg-[url('https://www.transparenttextures.com/patterns/graphy.png')]">
                    <div id="dict-viz-4" class="bg-white p-6 rounded-xl shadow-lg border border-border min-w-[200px]">
                        <span class="text-xs text-gray-400 font-bold uppercase tracking-widest mb-2 block">Estado
                            Actual</span>
                        <div class="font-mono text-primary text-lg">{ }</div>
                    </div>
                </div>
            </div>

            <div
                class="mt-6 flex gap-4 bg-blue-50 p-4 rounded-xl border border-blue-100 text-sm text-blue-800 items-center">
                <span>üí°</span>
                <p>Prueba comandos como: <code class="font-bold">persona["nombre"] = "Juan"</code> o simplemente escribe
                    <code class="font-bold">persona["nombre"]</code> para ver el valor.
                </p>
            </div>
        </div>
    </section>

    <!-- Slide 5: Modificar y Eliminar -->
    <section id="slide-5" class="slide flex-col p-8 items-center justify-center">
        <div
            class="bg-white p-8 rounded-3xl border border-border shadow-xl max-w-5xl w-full flex gap-12 relative overflow-hidden">
            <div class="absolute top-0 right-0 bg-yellow-400 text-white text-xs font-bold px-3 py-1 rounded-bl-xl z-20">
                MISI√ìN ACTIVA</div>

            <!-- Instructions Left -->
            <div class="w-1/3 flex flex-col justify-center">
                <h2 class="text-2xl font-black text-primary mb-4">Misi√≥n de Limpieza</h2>
                <ul class="space-y-4 text-sm text-gray-600 mb-8">
                    <li class="flex items-center gap-3">
                        <div class="w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center text-xs font-bold"
                            id="mission-step-1">1</div>
                        <span>Corrige "nombre" a "Dante".</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <div class="w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center text-xs font-bold"
                            id="mission-step-2">2</div>
                        <span>Elimina la clave "error".</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <div class="w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center text-xs font-bold"
                            id="mission-step-3">3</div>
                        <span>Deja solo 1 par clave-valor.</span>
                    </li>
                </ul>
                <div id="mission-success"
                    class="hidden bg-green-100 text-green-700 p-4 rounded-xl text-center font-bold animate-bounce">
                    ¬°Misi√≥n Cumplida! üéâ
                </div>
            </div>

            <!-- Workspace Right -->
            <div class="w-2/3 bg-muted rounded-xl p-6 relative">
                <!-- Visual Dict -->
                <div class="mb-4 flex gap-2 justify-center" id="dict-viz-5">
                    <!-- Cards generated by JS -->
                </div>

                <!-- Controls -->
                <div class="grid grid-cols-2 gap-4">
                    <button onclick="runMissionOp('mod')"
                        class="bg-white p-4 rounded-xl border border-border hover:border-action hover:shadow-md transition-all text-left group">
                        <div class="text-xs text-gray-400 font-bold mb-1">MODIFICAR</div>
                        <code
                            class="text-action font-bold group-hover:scale-105 block transition-transform">persona["nombre"] = "Dante"</code>
                    </button>
                    <button onclick="runMissionOp('del')"
                        class="bg-white p-4 rounded-xl border border-border hover:border-red-400 hover:shadow-md transition-all text-left group">
                        <div class="text-xs text-gray-400 font-bold mb-1">ELIMINAR</div>
                        <code
                            class="text-red-500 font-bold group-hover:scale-105 block transition-transform">del persona["error"]</code>
                    </button>
                    <button onclick="runMissionOp('clean')"
                        class="bg-white p-4 rounded-xl border border-border hover:border-red-400 hover:shadow-md transition-all text-left group col-span-2">
                        <div class="text-xs text-gray-400 font-bold mb-1">LIMPIEZA FINAL</div>
                        <code
                            class="text-red-500 font-bold group-hover:scale-105 block transition-transform">del persona["extra"]</code>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Slide 6: Recorrer -->
    <section id="slide-6" class="slide flex-col p-8 items-center justify-center">
        <h2 class="text-3xl font-bold text-primary mb-8">Recorrido de Diccionarios</h2>

        <div
            class="max-w-5xl w-full bg-white rounded-3xl border border-border shadow-xl p-8 min-h-[500px] flex flex-col">
            <!-- Tabs -->
            <div class="flex gap-4 mb-8 border-b border-border pb-4">
                <button onclick="setLoopMode('keys')" id="btn-keys"
                    class="flex-1 py-3 rounded-xl bg-muted font-bold text-gray-500 hover:bg-gray-200 transition-colors">.keys()</button>
                <button onclick="setLoopMode('values')" id="btn-values"
                    class="flex-1 py-3 rounded-xl bg-muted font-bold text-gray-500 hover:bg-gray-200 transition-colors">.values()</button>
                <button onclick="setLoopMode('items')" id="btn-items"
                    class="flex-1 py-3 rounded-xl bg-muted font-bold text-gray-500 hover:bg-gray-200 transition-colors">.items()</button>
            </div>

            <div class="flex gap-12 flex-1">
                <!-- Explanation & Code -->
                <div class="w-1/2">
                    <h3 id="loop-title" class="text-xl font-bold text-action mb-2">Recorrer Claves</h3>
                    <p id="loop-desc" class="text-gray-500 text-sm mb-6 leading-relaxed">
                        Este m√©todo es √∫til cuando solo necesitas las etiquetas. Es el comportamiento por defecto de un
                        bucle for sobre un diccionario.
                    </p>
                    <div
                        class="bg-muted p-4 rounded-xl font-mono text-sm border border-border relative overflow-hidden">
                        <div id="loop-code-highlight"
                            class="absolute left-0 top-0 w-1 h-6 bg-action transition-all duration-300 transform translate-y-2">
                        </div>
                        <div class="pl-4">
                            <span class="token-keyword">for</span> <span id="loop-var">k</span> <span
                                class="token-keyword">in</span> <span id="loop-source">datos.keys()</span>:<br>
                            &nbsp;&nbsp;<span class="token-function">print</span>(<span id="loop-print">k</span>)
                        </div>
                    </div>
                    <button onclick="runLoopAnim()"
                        class="mt-6 bg-primary text-white px-6 py-2 rounded-lg font-bold hover:bg-primary/90 transition-transform active:scale-95 flex items-center gap-2">
                        <span>‚ñ∂</span> Ejecutar Bucle
                    </button>
                </div>

                <!-- Visualization -->
                <div
                    class="w-1/2 bg-gray-50 rounded-xl p-6 border border-dashed border-gray-300 flex flex-col items-center justify-center relative">
                    <div class="absolute top-4 left-4 text-xs font-bold text-gray-400">MEMORIA</div>
                    <div class="flex flex-col gap-2 w-full max-w-xs" id="loop-viz-container">
                        <!-- Items -->
                        <div
                            class="loop-item p-3 bg-white border border-border rounded-lg flex justify-between opacity-50 transition-all">
                            <span class="font-bold text-primary">"id"</span>
                            <span class="text-gray-400">101</span>
                        </div>
                        <div
                            class="loop-item p-3 bg-white border border-border rounded-lg flex justify-between opacity-50 transition-all">
                            <span class="font-bold text-primary">"rol"</span>
                            <span class="text-gray-400">"admin"</span>
                        </div>
                        <div
                            class="loop-item p-3 bg-white border border-border rounded-lg flex justify-between opacity-50 transition-all">
                            <span class="font-bold text-primary">"active"</span>
                            <span class="text-gray-400">True</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Slide 7: Anidados -->
    <section id="slide-7" class="slide flex-col p-8 items-center justify-center">
        <h2 class="text-3xl font-bold text-primary mb-2">Diccionarios Anidados</h2>
        <p class="text-gray-500 mb-8">Modelando estructuras jer√°rquicas complejas.</p>

        <div class="flex gap-12 max-w-6xl w-full h-[500px]">
            <!-- Interactive Tree -->
            <div class="w-1/2 bg-white rounded-3xl border border-border shadow-lg p-8 overflow-y-auto">
                <div class="font-mono text-sm leading-relaxed cursor-pointer" id="json-tree">
                    <!-- JS Injected Tree -->
                </div>
            </div>

            <!-- Access Simulator -->
            <div class="w-1/2 flex flex-col justify-center gap-6">
                <div class="bg-action/5 p-6 rounded-2xl border-l-4 border-action">
                    <h3 class="font-bold text-action mb-2">Acceso Profundo</h3>
                    <p class="text-sm text-gray-600 mb-4">Para llegar a un valor interno, encadenamos las claves.</p>
                    <code
                        class="bg-white px-3 py-2 rounded border border-border font-mono text-sm text-primary block text-center shadow-sm">
                        datos["usuario"]["perfil"]["edad"]
                    </code>
                </div>

                <div class="text-center">
                    <div
                        class="inline-block p-4 bg-white rounded-full shadow-lg border border-border animate-bounce mb-2 text-2xl">
                        üëá</div>
                    <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Resultado</p>
                    <div class="text-4xl font-black text-primary mt-2">25</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Slide 8: Integraci√≥n -->
    <section id="slide-8" class="slide flex-col p-12 items-center justify-center">
        <h2 class="text-4xl font-black text-primary mb-12">Integraci√≥n de Estructuras</h2>

        <div class="grid grid-cols-2 gap-12 w-full max-w-5xl">
            <div class="bg-white p-8 rounded-3xl border border-border shadow-xl hover:scale-105 transition-transform">
                <div class="text-5xl mb-6">üì¶</div>
                <h3 class="text-2xl font-bold text-primary mb-4">Tuplas como Claves</h3>
                <p class="text-gray-500 mb-6">Como son inmutables, las tuplas son perfectas para coordenadas compuesta.
                </p>
                <div class="bg-muted p-4 rounded-xl font-mono text-sm text-gray-700 border border-border">
                    <span class="text-purple-600">{</span><br>
                    &nbsp;&nbsp;<span class="text-action">(10, 20)</span>: <span class="text-green-600">"Punto
                        A"</span>,<br>
                    &nbsp;&nbsp;<span class="text-action">(30, 40)</span>: <span class="text-green-600">"Punto
                        B"</span><br>
                    <span class="text-purple-600">}</span>
                </div>
            </div>

            <div
                class="bg-white p-8 rounded-3xl border border-border shadow-xl hover:scale-105 transition-transform delay-100">
                <div class="text-5xl mb-6">üèóÔ∏è</div>
                <h3 class="text-2xl font-bold text-primary mb-4">Sets como Valores</h3>
                <p class="text-gray-500 mb-6">Ideal para almacenar colecciones √∫nicas dentro de una categor√≠a.</p>
                <div class="bg-muted p-4 rounded-xl font-mono text-sm text-gray-700 border border-border">
                    <span class="text-purple-600">{</span><br>
                    &nbsp;&nbsp;<span class="text-action">"tags"</span>: <span class="text-green-600">{ "py", "js",
                        "web" }</span><br>
                    <span class="text-purple-600">}</span>
                </div>
            </div>
        </div>

        <div class="mt-12 opacity-50">
            <span class="text-sm font-bold tracking-widest uppercase">Fin del M√≥dulo</span>
        </div>
    </section>

    <!-- Footer Navigation -->
    <footer class="h-20 bg-white border-t border-border shrink-0 flex items-center justify-between px-12 z-50 relative">
        <button onclick="changeSlide(-1)" id="btn-prev"
            class="p-3 rounded-xl hover:bg-muted transition-colors text-primary disabled:opacity-30 disabled:cursor-not-allowed">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="m15 18-6-6 6-6" />
            </svg>
        </button>

        <div class="flex items-center gap-4">
            <div class="flex gap-2" id="nav-dots">
                <!-- Dynamic Dots -->
            </div>
            <span id="slide-counter" class="text-sm font-mono font-bold text-action/60 min-w-[3rem] text-center">1 /
                8</span>
        </div>

        <button onclick="changeSlide(1)" id="btn-next"
            class="p-3 bg-primary text-white rounded-xl shadow-lg hover:bg-primary/90 transition-transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="m9 18 6-6-6-6" />
            </svg>
        </button>
    </footer>

    <script>
        // --- State Management ---
        let currentSlide = 0;
        const totalSlides = 8;

        // --- Slide 2 Logic ---
        const defState = { "nombre": "Ana", "edad": 21 }; // Pre-populated data

        function renderDefVisuals() {
            const container = document.getElementById('def-cards-container');
            const empty = document.getElementById('def-empty-state');
            if (empty) empty.remove();

            // Clear current to rebuild safely or just appending? 
            // Better to clear and rebuild for simplicity in this specific constrained environment, 
            // or just ensure we don't duplicate.
            // Let's stick to the existing logic but make it callable.

            container.innerHTML = '';
            Object.entries(defState).forEach(([k, v]) => {
                const card = document.createElement('div');
                card.id = `def-card-${k}`;
                card.className = "bg-white p-3 rounded-lg border border-border flex justify-between items-center shadow-sm animate-[fadeIn_0.3s]";
                card.innerHTML = reformCard(k, v);
                container.appendChild(card);
            });

            // Update Code
            document.getElementById('def-code-display').textContent = "persona = " + JSON.stringify(defState, null, 4);
        }

        function addToDefinition() {
            const k = document.getElementById('def-key').value.trim();
            const v = document.getElementById('def-val').value.trim();
            if (!k || !v) return;

            defState[k] = isNaN(v) ? v : Number(v);
            renderDefVisuals();

            // Highlight specific card
            setTimeout(() => {
                const card = document.getElementById(`def-card-${k}`);
                if (card) {
                    card.classList.add('ring-2', 'ring-action');
                    setTimeout(() => card.classList.remove('ring-2', 'ring-action'), 300);
                }
            }, 50);

            // Clear inputs
            document.getElementById('def-key').value = '';
            document.getElementById('def-val').value = '';
        }

        function reformCard(k, v) {
            return `<span class="font-mono text-sm text-primary font-bold">"${k}"</span> <span class="text-gray-400">‚Üí</span> <span class="font-mono text-sm text-accent bg-accent/5 px-2 rounded">${JSON.stringify(v)}</span>`;
        }

        // --- Slide 3 Logic ---
        function showProp(id) {
            const content = document.getElementById('prop-detail-content');
            const data = {
                1: { title: "No Posicional", desc: "No usa √≠ndices [0]. Accedes por nombre.", viz: `lista[0] <span class="text-red-500">‚úñ</span><br>dicc["clave"] <span class="text-green-500">‚úî</span>` },
                2: { title: "Claves √önicas", desc: "Si repites una clave, el valor se sobrescribe. No puede haber duplicados.", viz: `{"id": 1, "id": 2} <br>‚ûî {"id": 2}` },
                3: { title: "Mutable", desc: "Puedes cambiar, agregar o borrar datos despu√©s de crearlo.", viz: `precio = 10<br>precio = 20` },
                4: { title: "Tipos", desc: "Claves: Inmutables (str, int, tupla). Valores: Cualquier cosa.", viz: `{ (1,1): "ok", "list": [1,2] }` }
            };

            content.innerHTML = `
                <div class="animate-[fadeIn_0.3s_ease-out]">
                    <h3 class="text-3xl font-black text-primary mb-4">${data[id].title}</h3>
                    <div class="bg-muted p-6 rounded-2xl mb-6 font-mono text-xl border border-border">${data[id].viz}</div>
                    <p class="text-lg text-gray-600 leading-relaxed">${data[id].desc}</p>
                </div>
            `;
        }

        // --- Slide 4 Logic ---
        let persona4 = {};
        function handleConsole4(e) {
            if (e.key === 'Enter') {
                const input = e.target.value.trim();
                const output = document.getElementById('console-output-4');
                const cleanInput = input.replace(/\s/g, '');

                // Add to history
                output.innerHTML += `<div class="text-gray-300">>>> ${input}</div>`;

                // Quick parser
                try {
                    if (cleanInput.startsWith("persona[") && cleanInput.includes("]=")) {
                        // Assignment
                        const parts = cleanInput.split("]=");
                        const key = parts[0].match(/["'](.+)["']/)[1];
                        const valRaw = parts[1];
                        const val = valRaw.startsWith('"') || valRaw.startsWith("'") ? valRaw.slice(1, -1) : Number(valRaw);

                        persona4[key] = val;
                        updateViz4();
                    } else if (cleanInput.startsWith("persona[") && !cleanInput.includes("=")) {
                        // Access
                        const key = cleanInput.match(/["'](.+)["']/)[1];
                        const res = persona4[key];
                        output.innerHTML += `<div class="text-action font-bold">${res !== undefined ? JSON.stringify(res) : 'Error: KeyError'}</div>`;
                    }
                } catch (err) {
                    output.innerHTML += `<div class="text-red-400">Error: Comando no reconocido</div>`;
                }

                e.target.value = '';
                output.scrollTop = output.scrollHeight;
            }
        }

        function updateViz4() {
            document.getElementById('dict-viz-4').innerHTML = `
                <span class="text-xs text-gray-400 font-bold uppercase tracking-widest mb-2 block">Estado Actual</span>
                <div class="font-mono text-primary text-lg whitespace-pre">${JSON.stringify(persona4, null, 2)}</div>
            `;
        }

        // --- Slide 5 Logic ---
        let persona5 = { "nombre": "Error", "edad": 25, "error": "borrame", "extra": 10 };
        function initSlide5Visuals() {
            const container = document.getElementById('dict-viz-5');
            container.innerHTML = '';
            Object.entries(persona5).forEach(([k, v]) => {
                const div = document.createElement('div');
                div.className = "bg-white p-3 rounded-lg border border-border shadow-sm text-sm font-mono flex flex-col items-center min-w-[80px] transition-all duration-500";
                div.id = `card-5-${k}`;
                div.innerHTML = `<span class="text-green-600 font-bold">"${k}"</span><span class="text-gray-300">‚¨á</span><span class="text-blue-600">${JSON.stringify(v)}</span>`;
                container.appendChild(div);
            });
            checkMission();
        }

        function runMissionOp(op) {
            if (op === 'mod') {
                persona5["nombre"] = "Dante";
                document.getElementById('mission-step-1').classList.add('bg-green-500', 'text-white');
            } else if (op === 'del') {
                delete persona5["error"];
                const card = document.getElementById(`card-5-error`);
                if (card) { card.style.transform = 'scale(0)'; setTimeout(() => card.remove(), 500); }
                document.getElementById('mission-step-2').classList.add('bg-green-500', 'text-white');
            } else if (op === 'clean') {
                delete persona5["extra"];
                const card = document.getElementById(`card-5-extra`);
                if (card) { card.style.transform = 'scale(0)'; setTimeout(() => card.remove(), 500); }
            }
            initSlide5Visuals();
        }

        function checkMission() {
            const keys = Object.keys(persona5);
            if (persona5["nombre"] === "Dante" && !keys.includes("error") && keys.length === 2 && !keys.includes("extra")) {
                document.getElementById('mission-step-3').classList.add('bg-green-500', 'text-white');
                document.getElementById('mission-success').classList.remove('hidden');
            }
        }

        // --- Slide 6 Logic ---
        const data6 = { "id": 101, "rol": "admin", "active": true }; /* Simulate Python True in JS for viz? No, string for easy usage */
        const vizItems = [
            { k: '"id"', v: '101' },
            { k: '"rol"', v: '"admin"' },
            { k: '"active"', v: 'True' }
        ];
        let currentLoop = 'keys';

        function setLoopMode(mode) {
            currentLoop = mode;
            // Reset styles
            ['keys', 'values', 'items'].forEach(m => document.getElementById(`btn-${m}`).classList.remove('bg-action', 'text-white'));
            document.getElementById(`btn-${mode}`).classList.add('bg-action', 'text-white');

            // Content
            const texts = {
                keys: { title: "Recorrer Claves (.keys)", desc: "Itera solo por las etiquetas. Es lo que ocurre por defecto en un for x in dict.", code: "datos.keys()", var: "k" },
                values: { title: "Recorrer Valores (.values)", desc: "Itera solo por el contenido, ignorando las etiquetas.", code: "datos.values()", var: "v" },
                items: { title: "Recorrer Items (.items)", desc: "Entrega tuplas (clave, valor). Es el m√°s completo.", code: "datos.items()", var: "k, v" }
            };

            document.getElementById('loop-title').textContent = texts[mode].title;
            document.getElementById('loop-desc').textContent = texts[mode].desc;
            document.getElementById('loop-source').textContent = texts[mode].code;
            document.getElementById('loop-var').textContent = texts[mode].var;
            document.getElementById('loop-print').textContent = texts[mode].var;
        }

        function runLoopAnim() {
            const container = document.getElementById('loop-viz-container');
            const nodes = container.children;
            const highlight = document.getElementById('loop-code-highlight');

            // Animation Sequence
            highlight.style.transform = 'translateY(24px)'; // Move to for line

            let i = 0;
            const interval = setInterval(() => {
                if (i >= nodes.length) {
                    clearInterval(interval);
                    highlight.style.transform = 'translateY(8px)';
                    Array.from(nodes).forEach(n => n.style.opacity = '0.5');
                    return;
                }

                // Reset
                Array.from(nodes).forEach(n => { n.style.opacity = '0.5'; n.classList.remove('scale-105', 'border-action'); });

                // Highlight Current
                const curr = nodes[i];
                curr.style.opacity = '1';
                curr.classList.add('scale-105', 'border-action');

                // Highlight part
                const keySpan = curr.querySelector('span:first-child');
                const valSpan = curr.querySelector('span:last-child');

                if (currentLoop === 'keys') { keySpan.style.color = '#0055ad'; }
                else if (currentLoop === 'values') { valSpan.style.color = '#0055ad'; }
                else { keySpan.style.color = '#0055ad'; valSpan.style.color = '#0055ad'; }

                setTimeout(() => {
                    keySpan.style.color = '';
                    valSpan.style.color = '';
                }, 800);

                highlight.style.transform = 'translateY(48px)'; // Print line
                setTimeout(() => highlight.style.transform = 'translateY(24px)', 400); // Back to loop

                i++;
            }, 1000);
        }

        // --- Slide 7 Logic (Tree) ---
        const treeData = {
            "usuario": {
                "perfil": {
                    "nombre": "Ana",
                    "edad": 25
                },
                "stats": {
                    "login": "2023-01-01"
                }
            }
        };

        function renderTree(obj, container) {
            Object.entries(obj).forEach(([k, v]) => {
                const line = document.createElement('div');
                line.className = "mb-2";

                if (typeof v === 'object' && v !== null) {
                    line.innerHTML = `<span class="text-purple-600 font-bold">"${k}"</span>: <span class="text-gray-400">{</span>`;
                    container.appendChild(line);

                    const childrenContainer = document.createElement('div');
                    childrenContainer.className = "tree-line";
                    container.appendChild(childrenContainer);
                    renderTree(v, childrenContainer);

                    const close = document.createElement('div');
                    close.innerHTML = `<span class="text-gray-400">}</span>`;
                    container.appendChild(close);
                } else {
                    line.innerHTML = `<span class="text-primary font-bold">"${k}"</span>: <span class="text-green-600">"${v}"</span>`;
                    container.appendChild(line);
                }
            });
        }

        // --- Navigation Core ---
        function init() {
            // Render Dots
            const dots = document.getElementById('nav-dots');
            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('div');
                dot.className = `w-3 h-3 rounded-full transition-all duration-300 ${i === 0 ? 'bg-primary scale-110' : 'bg-gray-300'}`;
                dots.appendChild(dot);
            }
            updateSlideView();
            renderDefVisuals(); // Init Slide 2 visuals
            initSlide5Visuals();
            renderTree(treeData, document.getElementById('json-tree'));
        }

        function changeSlide(dir) {
            currentSlide += dir;
            if (currentSlide < 0) currentSlide = 0;
            if (currentSlide >= totalSlides) currentSlide = totalSlides - 1;
            updateSlideView();
        }

        function updateSlideView() {
            // Visibility
            document.querySelectorAll('.slide').forEach((s, idx) => {
                if (idx === currentSlide) s.classList.add('active');
                else s.classList.remove('active');
            });

            // Buttons
            document.getElementById('btn-prev').disabled = currentSlide === 0;
            document.getElementById('btn-next').disabled = currentSlide === totalSlides - 1;

            // Dots
            const navDots = document.getElementById('nav-dots').children;
            Array.from(navDots).forEach((d, idx) => {
                d.className = `w-3 h-3 rounded-full transition-all duration-300 ${idx === currentSlide ? 'bg-primary scale-110 shadow-md' : 'bg-gray-300'}`;
            });

            // Update Counter
            document.getElementById('slide-counter').textContent = `${currentSlide + 1} / ${totalSlides}`;
        }

        // Init
        document.addEventListener('DOMContentLoaded', init);

        // Keyboard Support
        window.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') changeSlide(1);
            if (e.key === 'ArrowLeft') changeSlide(-1);
        });

    </script>
</body>

</html>