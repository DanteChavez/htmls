<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unidad 2 - M√≥dulo 03: Diccionarios en Python</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#003c58',
                        accent: '#06717e',
                        action: '#0055ad',
                        'action-hover': '#399be2',
                        muted: '#f1f5f9',
                        dark: '#0f6cbf',
                        'sky-text': '#6ea2ee',
                        'muted-text': '#6da8e9',
                        'deep-text': '#1e293b',
                        border: '#e2e8f0',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    }
                }
            }
        }
    </script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden;
        }

        .slide {
            display: none;
            height: 100%;
            width: 100%;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .slide.active {
            display: flex;
            opacity: 1;
        }

        /* VS Code Theme */
        .token-keyword {
            color: #c586c0;
        }

        .token-function {
            color: #dcdcaa;
        }

        .token-string {
            color: #ce9178;
        }

        .token-number {
            color: #b5cea8;
        }

        .token-comment {
            color: #6a9955;
            font-style: italic;
        }

        .code-bg {
            background-color: #1e1e1e;
            color: #d4d4d4;
        }

        /* Light Theme VS Code */
        .light-code .token-keyword {
            color: #AF00DB;
        }

        .light-code .token-function {
            color: #795E26;
        }

        .light-code .token-string {
            color: #a31515;
        }

        .light-code .token-number {
            color: #098658;
        }

        .light-code .token-comment {
            color: #008000;
        }

        .light-code {
            background-color: #ffffff;
            color: #000000;
        }

        .mac-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .mac-red {
            background-color: #ff5f56;
        }

        .mac-yellow {
            background-color: #ffbd2e;
        }

        .mac-green {
            background-color: #27c93f;
        }

        /* Tree View */
        .tree-line {
            border-left: 1px dashed #cbd5e1;
            margin-left: 10px;
            padding-left: 20px;
        }
    </style>
</head>

<body class="bg-muted text-deep-text h-screen flex flex-col">

    <!-- Slide 1: Portada -->
    <section id="slide-1" class="slide active items-center justify-center p-12">
        <div class="text-center max-w-4xl animate-[fadeIn_1s_ease-out]">
            <h2 class="text-accent font-bold tracking-[0.2em] uppercase mb-4 text-sm">Unidad 2 - M√≥dulo 03</h2>
            <h1 class="text-6xl font-black text-primary mb-6 leading-tight">Diccionarios en Python</h1>
            <p class="text-2xl text-muted-text font-light mb-12">Estructuras basadas en <span
                    class="font-bold text-action">clave-valor</span></p>
            <div class="h-1 w-24 bg-action mx-auto rounded-full mb-8"></div>
            <p class="text-gray-500 max-w-xl mx-auto">Aprender√°s a crear, modificar, recorrer y organizar datos usando
                diccionarios de manera eficiente.</p>
        </div>
    </section>

    <!-- Slide 2: Definici√≥n -->
    <section id="slide-2" class="slide flex-col p-8 items-center justify-center">
        <div class="max-w-6xl w-full text-center mb-8">
            <h2 class="text-3xl font-bold text-primary mb-6">¬øQu√© es un Diccionario?</h2>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto mb-8">
                Es una estructura que almacena datos en pares <span
                    class="bg-primary/10 text-primary px-2 rounded font-bold">CLAVE</span> - <span
                    class="bg-accent/10 text-accent px-2 rounded font-bold">VALOR</span>.
                La <span class="font-bold text-primary">clave</span> es la etiqueta √∫nica para acceder a la informaci√≥n.
            </p>
        </div>

        <div class="grid grid-cols-2 gap-12 max-w-6xl w-full h-[500px]">
            <!-- Visual Interaction -->
            <div class="bg-white rounded-3xl p-8 border border-border shadow-lg flex flex-col">
                <h3 class="font-bold text-primary mb-6 flex items-center gap-2"><span class="text-2xl">üè∑Ô∏è</span>
                    Constructor Visual</h3>

                <div class="flex gap-4 mb-6">
                    <input id="def-key" type="text" placeholder="Clave (ej: 'Ciudad')"
                        class="border border-border rounded-lg p-3 w-1/2 focus:ring-2 focus:ring-action outline-none text-sm font-mono">
                    <input id="def-val" type="text" placeholder="Valor (ej: 'Valpara√≠so')"
                        class="border border-border rounded-lg p-3 w-1/2 focus:ring-2 focus:ring-action outline-none text-sm font-mono">
                </div>
                <button onclick="addToDefinition()"
                    class="bg-action text-white font-bold py-3 rounded-xl hover:bg-action-hover transition-colors mb-6 shadow-md">
                    Agregar Par Clave-Valor
                </button>

                <div id="def-cards-container"
                    class="flex-1 overflow-y-auto space-y-3 p-2 bg-muted/30 rounded-xl relative">
                    <div id="def-empty-state"
                        class="absolute inset-0 flex items-center justify-center text-gray-400 text-sm italic pointer-events-none">
                        Agrega elementos para visualizar...
                    </div>
                </div>
            </div>

            <!-- Code Preview -->
            <div class="flex flex-col">
                <div class="bg-white rounded-t-3xl border border-border border-b-0 p-4 flex gap-2 items-center">
                    <div class="mac-btn mac-red"></div>
                    <div class="mac-btn mac-yellow"></div>
                    <div class="mac-btn mac-green"></div>
                    <span class="ml-4 text-xs font-mono text-gray-400">visualizacion.py</span>
                </div>
                <div
                    class="bg-white border border-border rounded-b-3xl p-6 flex-1 font-mono text-sm light-code shadow-lg relative overflow-hidden">
                    <div id="def-code-display" class="whitespace-pre">persona = {}</div>

                    <div
                        class="absolute bottom-0 left-0 right-0 bg-yellow-50 p-4 border-t border-yellow-100 text-xs text-yellow-800 flex items-start gap-2">
                        <span>üí°</span>
                        <p>El acceso es directo: <code
                                class="bg-yellow-100 px-1 rounded font-bold">persona["clave"]</code>. Si repites la
                            clave, el valor se sobrescribe.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Slide 3: Propiedades -->
    <section id="slide-3" class="slide flex-col p-12 items-center">
        <h2 class="text-4xl font-black text-primary mb-12">Propiedades Fundamentales</h2>

        <div class="max-w-6xl w-full grid grid-cols-1 md:grid-cols-2 gap-12 items-center flex-1">
            <!-- Properties List (Selectable) -->
            <div class="space-y-4">
                <div onclick="selectProp3(1)" id="prop-btn-1"
                    class="p-4 rounded-xl border border-transparent hover:bg-white hover:shadow-md transition-all cursor-pointer flex items-start gap-4 group">
                    <span
                        class="bg-accent text-white rounded-full p-1 mt-1 shrink-0 group-hover:scale-110 transition-transform">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7">
                            </path>
                        </svg>
                    </span>
                    <div>
                        <strong class="text-primary block text-lg">No Posicional</strong>
                        <span class="text-gray-500 text-sm">No importa el orden, importa la etiqueta.</span>
                    </div>
                </div>

                <div onclick="selectProp3(2)" id="prop-btn-2"
                    class="p-4 rounded-xl border border-transparent hover:bg-white hover:shadow-md transition-all cursor-pointer flex items-start gap-4 group">
                    <span
                        class="bg-accent text-white rounded-full p-1 mt-1 shrink-0 group-hover:scale-110 transition-transform">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7">
                            </path>
                        </svg>
                    </span>
                    <div>
                        <strong class="text-primary block text-lg">Claves √önicas</strong>
                        <span class="text-gray-500 text-sm">No pueden repetirse (se sobrescriben).</span>
                    </div>
                </div>

                <div onclick="selectProp3(3)" id="prop-btn-3"
                    class="p-4 rounded-xl border border-transparent hover:bg-white hover:shadow-md transition-all cursor-pointer flex items-start gap-4 group">
                    <span
                        class="bg-accent text-white rounded-full p-1 mt-1 shrink-0 group-hover:scale-110 transition-transform">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7">
                            </path>
                        </svg>
                    </span>
                    <div>
                        <strong class="text-primary block text-lg">Mutable</strong>
                        <span class="text-gray-500 text-sm">Puedes cambiar sus datos libremente.</span>
                    </div>
                </div>

                <div onclick="selectProp3(4)" id="prop-btn-4"
                    class="p-4 rounded-xl border border-transparent hover:bg-white hover:shadow-md transition-all cursor-pointer flex items-start gap-4 group">
                    <span
                        class="bg-accent text-white rounded-full p-1 mt-1 shrink-0 group-hover:scale-110 transition-transform">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7">
                            </path>
                        </svg>
                    </span>
                    <div>
                        <strong class="text-primary block text-lg">Tipos Mixtos</strong>
                        <span class="text-gray-500 text-sm">Acepta cualquier tipo de valor.</span>
                    </div>
                </div>
            </div>

            <!-- Dynamic Right Panel -->
            <div id="slide3-right-panel" class="flex flex-col gap-8 h-full">
                <!-- Content injected by JS -->
            </div>
        </div>
    </section>

    <!-- Slide 4: Agregar y Acceder -->
    <section id="slide-4" class="slide flex-col p-8 items-center justify-center">
        <div class="max-w-5xl w-full">
            <div class="max-w-5xl w-full relative">
                <div class="flex justify-between items-end mb-6">
                    <h2 class="text-3xl font-bold text-primary">Crear, Agregar y Acceder</h2>
                    <button onclick="resetTutorial()"
                        class="text-sm text-action hover:underline flex items-center gap-1">
                        <span>‚Ü∫</span> Repetir Tutorial
                    </button>
                </div>

                <!-- Theory Block -->
                <div class="grid grid-cols-3 gap-4 mb-8">
                    <div id="step-create"
                        class="bg-blue-50 p-3 rounded-xl border border-blue-100 text-center transition-all duration-300 relative">
                        <div class="text-xs font-bold text-blue-600 uppercase tracking-wider mb-2">1. Crear</div>
                        <code
                            class="bg-white px-2 py-1 rounded border border-blue-200 text-sm font-mono block">libro = {}</code>
                    </div>
                    <div id="step-add"
                        class="bg-green-50 p-3 rounded-xl border border-green-100 text-center transition-all duration-300 relative">
                        <div class="text-xs font-bold text-green-600 uppercase tracking-wider mb-2">2. Agregar</div>
                        <code
                            class="bg-white px-2 py-1 rounded border border-green-200 text-sm font-mono block">libro["clave"] = valor</code>
                    </div>
                    <div id="step-access"
                        class="bg-purple-50 p-3 rounded-xl border border-purple-100 text-center transition-all duration-300 relative">
                        <div class="text-xs font-bold text-purple-600 uppercase tracking-wider mb-2">3. Acceder</div>
                        <code
                            class="bg-white px-2 py-1 rounded border border-purple-200 text-sm font-mono block">print(libro["clave"])</code>
                    </div>
                </div>

                <!-- Tutorial Contextual Panel (Hidden by default) -->
                <div id="tutorial-panel"
                    class="absolute z-50 bg-white p-4 rounded-xl shadow-2xl border-l-4 border-action max-w-[250px] transition-all duration-500 opacity-0 pointer-events-none transform translate-y-2">
                    <div class="text-sm font-bold text-gray-800 mb-2" id="tut-title">T√≠tulo</div>
                    <p class="text-xs text-gray-600 mb-3" id="tut-desc">Descripci√≥n...</p>
                    <div class="flex justify-end">
                        <button id="tut-next-btn" onclick="nextTutorialStep()"
                            class="bg-action text-white text-xs px-3 py-1 rounded hover:bg-blue-600 transition-colors">Siguiente</button>
                    </div>
                    <!-- Arrow -->
                    <div
                        class="absolute w-3 h-3 bg-white border-l border-t border-gray-200 transform rotate-45 -top-1.5 left-1/2 -translate-x-1/2">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-8 h-[500px]">
                    <!-- Interactive Console -->
                    <div class="bg-[#1e1e1e] rounded-xl p-4 font-mono text-sm text-gray-300 flex flex-col shadow-xl">
                        <div class="flex gap-2 mb-4 border-b border-gray-700 pb-2">
                            <div class="w-3 h-3 rounded-full bg-red-500"></div>
                            <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        </div>
                        <div class="flex-1 overflow-y-auto mb-4 scrollbar-hide" id="console-output-4">
                            <div class="text-gray-500 italic"># Consola interactiva de Python</div>
                        </div>
                        <div class="flex gap-2 items-center border-t border-gray-700 pt-3">
                            <span class="text-blue-400 font-bold">>>></span>
                            <input id="console-input-4" type="text"
                                class="bg-transparent outline-none flex-1 text-white" placeholder="Comando..."
                                onkeydown="handleConsole4(event)" autocomplete="off">
                        </div>
                    </div>

                    <!-- Visual State -->
                    <div
                        class="bg-white border-2 border-dashed border-border rounded-xl p-8 flex items-center justify-center relative bg-[url('https://www.transparenttextures.com/patterns/graphy.png')]">
                        <div id="dict-viz-4"
                            class="bg-white p-6 rounded-xl shadow-lg border border-border min-w-[200px]">
                            <span class="text-xs text-gray-400 font-bold uppercase tracking-widest mb-2 block">Estado
                                Actual</span>
                            <div class="font-mono text-primary text-lg">{ }</div>
                        </div>
                    </div>
                </div>

            </div>
    </section>

    <!-- Slide 5: Modificar y Eliminar -->
    <section id="slide-5" class="slide flex-col p-8 items-center justify-center">
        <div class="max-w-5xl w-full relative">
            <div class="flex justify-between items-end mb-6">
                <h2 class="text-3xl font-bold text-primary">Modificar y Eliminar</h2>
                <button onclick="resetTutorial5()" class="text-sm text-action hover:underline flex items-center gap-1">
                    <span>‚Ü∫</span> Repetir Tutorial
                </button>
            </div>

            <!-- Theory Block -->
            <div class="grid grid-cols-3 gap-4 mb-8">
                <div id="step-mod"
                    class="bg-blue-50 p-3 rounded-xl border border-blue-100 text-center transition-all duration-300 relative">
                    <div class="text-xs font-bold text-blue-600 uppercase tracking-wider mb-2">1. Modificar</div>
                    <code
                        class="bg-white px-2 py-1 rounded border border-blue-200 text-sm font-mono block">libro["k"] = "nuevo"</code>
                </div>
                <div id="step-del"
                    class="bg-red-50 p-3 rounded-xl border border-red-100 text-center transition-all duration-300 relative">
                    <div class="text-xs font-bold text-red-600 uppercase tracking-wider mb-2">2. Eliminar (del)</div>
                    <code
                        class="bg-white px-2 py-1 rounded border border-red-200 text-sm font-mono block">del libro["k"]</code>
                </div>
                <div id="step-pop"
                    class="bg-orange-50 p-3 rounded-xl border border-orange-100 text-center transition-all duration-300 relative">
                    <div class="text-xs font-bold text-orange-600 uppercase tracking-wider mb-2">3. M√©todo pop()</div>
                    <code
                        class="bg-white px-2 py-1 rounded border border-orange-200 text-sm font-mono block">libro.pop("k")</code>
                </div>
            </div>

            <!-- Tutorial Contextual Panel -->
            <div id="tutorial-panel-5"
                class="absolute z-50 bg-white p-4 rounded-xl shadow-2xl border-l-4 border-action max-w-[250px] transition-all duration-500 opacity-0 pointer-events-none transform translate-y-2">
                <div class="text-sm font-bold text-gray-800 mb-2" id="tut-title-5">T√≠tulo</div>
                <p class="text-xs text-gray-600 mb-3" id="tut-desc-5">Descripci√≥n...</p>
                <div class="flex justify-end">
                    <button id="tut-next-btn-5" onclick="nextTutorialStep5()"
                        class="bg-action text-white text-xs px-3 py-1 rounded hover:bg-blue-600 transition-colors">Siguiente</button>
                </div>
                <!-- Arrow -->
                <div
                    class="absolute w-3 h-3 bg-white border-l border-t border-gray-200 transform rotate-45 -top-1.5 left-1/2 -translate-x-1/2">
                </div>
            </div>

            <div class="grid grid-cols-2 gap-8 h-[500px]">
                <!-- Interactive Console -->
                <div class="bg-[#1e1e1e] rounded-xl p-4 font-mono text-sm text-gray-300 flex flex-col shadow-xl">
                    <div class="flex gap-2 mb-4 border-b border-gray-700 pb-2">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    </div>
                    <div class="flex-1 overflow-y-auto mb-4 scrollbar-hide" id="console-output-5">
                        <div class="text-gray-500 italic"># Consola interactiva de Python</div>
                    </div>
                    <div class="flex gap-2 items-center border-t border-gray-700 pt-3">
                        <span class="text-blue-400 font-bold">>>></span>
                        <input id="console-input-5" type="text" class="bg-transparent outline-none flex-1 text-white"
                            placeholder="Comando..." onkeydown="handleConsole5(event)" autocomplete="off">
                    </div>
                </div>

                <!-- Visual State -->
                <div
                    class="bg-white border-2 border-dashed border-border rounded-xl p-8 flex items-center justify-center relative bg-[url('https://www.transparenttextures.com/patterns/graphy.png')]">
                    <div id="dict-viz-5" class="bg-white p-6 rounded-xl shadow-lg border border-border min-w-[200px]">
                        <!-- JS generated -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Slide 6: Recorrer -->
    <section id="slide-6" class="slide flex-col p-8 items-center justify-center">
        <h2 class="text-3xl font-bold text-primary mb-8">Recorrido de Diccionarios</h2>

        <div
            class="max-w-5xl w-full bg-white rounded-3xl border border-border shadow-xl p-8 min-h-[500px] flex flex-col">
            <!-- Tabs -->
            <div class="flex gap-4 mb-8 border-b border-border pb-4">
                <button onclick="setLoopMode('keys')" id="btn-keys"
                    class="flex-1 py-3 rounded-xl bg-muted font-bold text-gray-500 hover:bg-gray-200 transition-colors">.keys()</button>
                <button onclick="setLoopMode('values')" id="btn-values"
                    class="flex-1 py-3 rounded-xl bg-muted font-bold text-gray-500 hover:bg-gray-200 transition-colors">.values()</button>
                <button onclick="setLoopMode('items')" id="btn-items"
                    class="flex-1 py-3 rounded-xl bg-muted font-bold text-gray-500 hover:bg-gray-200 transition-colors">.items()</button>
            </div>

            <div class="flex gap-12 flex-1">
                <!-- Explanation & Code -->
                <div class="w-1/2">
                    <h3 id="loop-title" class="text-xl font-bold text-action mb-2">Recorrer Claves</h3>
                    <p id="loop-desc" class="text-gray-500 text-sm mb-6 leading-relaxed">
                        Este m√©todo es √∫til cuando solo necesitas las etiquetas. Es el comportamiento por defecto de un
                        bucle for sobre un diccionario.
                    </p>
                    <div
                        class="bg-muted p-4 rounded-xl font-mono text-sm border border-border relative overflow-hidden">
                        <div id="loop-code-highlight"
                            class="absolute left-0 top-0 w-1 h-6 bg-action transition-all duration-300 transform translate-y-2">
                        </div>
                        <div class="pl-4">
                            <span class="token-keyword">for</span> <span id="loop-var">k</span> <span
                                class="token-keyword">in</span> <span id="loop-source">libro.keys()</span>:<br>
                            &nbsp;&nbsp;<span class="token-function">print</span>(<span id="loop-print">k</span>)
                        </div>
                    </div>
                    <button onclick="runLoopAnim()"
                        class="mt-6 bg-primary text-white px-6 py-2 rounded-lg font-bold hover:bg-primary/90 transition-transform active:scale-95 flex items-center gap-2">
                        <span>‚ñ∂</span> Ejecutar Bucle
                    </button>
                </div>

                <!-- Right Side: Visualization & Console -->
                <div class="w-1/2 flex flex-col gap-4">
                    <!-- Visualization -->
                    <div
                        class="flex-1 bg-gray-50 rounded-xl p-6 border border-dashed border-gray-300 flex flex-col items-center justify-center relative">
                        <div class="absolute top-4 left-4 text-xs font-bold text-gray-400 uppercase tracking-widest">
                            Memoria</div>

                        <!-- Dictionary Name Display -->
                        <div class="w-full max-w-xs mb-2 flex items-center gap-2">
                            <span class="font-mono text-sm font-bold text-primary">libro =</span>
                            <span class="font-mono text-sm text-gray-400">{ ... }</span>
                        </div>

                        <!-- Table Headers -->
                        <div class="w-full max-w-xs flex justify-between px-3 mb-1">
                            <span class="text-[10px] font-bold text-gray-400 uppercase tracking-tighter">Clave</span>
                            <span class="text-[10px] font-bold text-gray-400 uppercase tracking-tighter">Valor</span>
                        </div>

                        <div class="flex flex-col gap-2 w-full max-w-xs" id="loop-viz-container">
                            <!-- Items initialized by JS -->
                        </div>
                    </div>

                    <!-- Console -->
                    <div
                        class="h-48 bg-[#1e1e1e] rounded-xl p-4 font-mono text-sm text-gray-300 flex flex-col shadow-xl overflow-hidden">
                        <div class="flex gap-2 mb-2 border-b border-gray-700 pb-2 shrink-0">
                            <div class="w-2 h-2 rounded-full bg-red-500/50"></div>
                            <div class="w-2 h-2 rounded-full bg-yellow-500/50"></div>
                            <div class="w-2 h-2 rounded-full bg-green-500/50"></div>
                            <span class="text-[10px] text-gray-500 uppercase ml-2 tracking-widest">Salida de
                                Consola</span>
                        </div>
                        <div class="flex-1 overflow-y-auto scrollbar-hide" id="console-output-6">
                            <div class="text-gray-500 italic text-xs"># Los resultados aparecer√°n aqu√≠...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Slide 7: Anidados -->
    <section id="slide-7" class="slide flex-col p-8 items-center justify-center">
        <h2 class="text-3xl font-bold text-primary mb-2">Diccionarios Anidados</h2>
        <p class="text-gray-500 mb-8">Modelando estructuras jer√°rquicas complejas.</p>

        <div class="flex gap-12 max-w-6xl w-full h-auto min-h-[600px]">
            <!-- Mac-style Code Editor -->
            <div class="w-1/2 flex flex-col">
                <div class="bg-[#1e1e1e] rounded-t-xl p-3 flex items-center gap-2 border-b border-gray-700">
                    <div class="w-3 h-3 rounded-full bg-[#ff5f56]"></div>
                    <div class="w-3 h-3 rounded-full bg-[#ffbd2e]"></div>
                    <div class="w-3 h-3 rounded-full bg-[#27c93f]"></div>
                    <span class="text-xs text-gray-400 font-mono ml-2">estudiante.py</span>
                </div>
                <div
                    class="bg-white border-l border-r border-b border-gray-300 rounded-b-xl p-6 overflow-y-auto flex-1 font-mono text-sm leading-relaxed shadow-lg">
                    <span class="text-primary font-bold">estudiante</span> = {<br>
                    &nbsp;&nbsp;<span class="text-primary">"nombre"</span>: <span
                        class="text-green-600">"Pedro"</span>,<br>
                    &nbsp;&nbsp;<span class="text-primary">"edad"</span>: <span class="text-action">18</span>,<br>
                    &nbsp;&nbsp;<span class="text-primary">"carrera"</span>: <span class="text-green-600">"Ing.
                        Inform√°tica"</span>,<br><br>
                    &nbsp;&nbsp;<span class="text-primary">"notas"</span>: {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="text-primary">"matematicas"</span>: <span
                        class="text-action">6.5</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="text-primary">"programacion"</span>: <span
                        class="text-action">7.0</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="text-primary">"fisica"</span>: <span
                        class="text-action">5.8</span><br>
                    &nbsp;&nbsp;},<br><br>
                    &nbsp;&nbsp;<span class="text-primary">"direccion"</span>: {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="text-primary">"calle"</span>: <span class="text-green-600">"Av.
                        Libertador 123"</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="text-primary">"ciudad"</span>: <span
                        class="text-green-600">"Santiago"</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="text-primary">"region"</span>: {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-primary">"nombre"</span>: <span
                        class="text-green-600">"Metropolitana"</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-primary">"codigo"</span>: <span
                        class="text-green-600">"RM"</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    &nbsp;&nbsp;}<br>
                    }
                </div>
            </div>

            <!-- Access & Console -->
            <div class="w-1/2 flex flex-col justify-center gap-6">
                <div class="bg-action/5 p-6 rounded-2xl border-l-4 border-action">
                    <h3 class="font-bold text-action mb-2">Acceso Profundo</h3>
                    <p class="text-sm text-gray-600 mb-4">Para llegar a un valor interno, encadenamos las claves.</p>
                    <div
                        class="relative pt-10 pb-10 px-2 bg-white rounded-xl border border-border shadow-sm text-center overflow-x-auto">
                        <div class="font-mono text-lg text-primary whitespace-nowrap">
                            <span class="text-gray-400">print(</span>
                            <div class="inline-block relative">
                                <span class="font-bold text-primary">estudiante</span>
                                <div
                                    class="absolute -bottom-10 left-1/2 -translate-x-1/2 text-[10px] font-bold text-primary uppercase tracking-wider whitespace-nowrap">
                                    Diccionario
                                    <div class="w-px h-3 bg-primary absolute -top-3 left-1/2 -translate-x-1/2"></div>
                                </div>
                            </div>
                            <span class="text-gray-400">[</span>
                            <div class="inline-block relative">
                                <span class="text-action">"notas"</span>
                                <div
                                    class="absolute -bottom-10 left-1/2 -translate-x-1/2 text-[10px] font-bold text-action uppercase tracking-wider whitespace-nowrap">
                                    Sub-Dicc
                                    <div class="w-px h-3 bg-action absolute -top-3 left-1/2 -translate-x-1/2"></div>
                                </div>
                            </div>
                            <span class="text-gray-400">][</span>
                            <div class="inline-block relative">
                                <span class="text-action">"matematicas"</span>
                                <div
                                    class="absolute -bottom-10 left-1/2 -translate-x-1/2 text-[10px] font-bold text-purple-600 uppercase tracking-wider whitespace-nowrap">
                                    Clave
                                    <div class="w-px h-3 bg-purple-600 absolute -top-3 left-1/2 -translate-x-1/2">
                                    </div>
                                </div>
                            </div>
                            <span class="text-gray-400">])</span>
                        </div>
                    </div>
                </div>

                <!-- Console -->
                <div
                    class="h-48 bg-[#1e1e1e] rounded-xl p-4 font-mono text-sm text-gray-300 flex flex-col shadow-xl overflow-hidden">
                    <div class="flex gap-2 mb-2 border-b border-gray-700 pb-2 shrink-0">
                        <div class="w-2 h-2 rounded-full bg-red-500/50"></div>
                        <div class="w-2 h-2 rounded-full bg-yellow-500/50"></div>
                        <div class="w-2 h-2 rounded-full bg-green-500/50"></div>
                        <span class="text-[10px] text-gray-500 uppercase ml-2 tracking-widest">Terminal</span>
                    </div>
                    <div class="flex-1 overflow-y-auto scrollbar-hide">
                        <div class="text-green-400">>>> print(estudiante["notas"]["matematicas"])</div>
                        <div class="text-white mt-1">6.5</div>
                        <div class="text-green-400 mt-2">>>> <span class="animate-pulse">_</span></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Slide 8: Integraci√≥n -->
    <section id="slide-8" class="slide flex-col p-12 items-center justify-center">
        <h2 class="text-4xl font-black text-primary mb-12">Integraci√≥n de Estructuras</h2>

        <div class="grid grid-cols-2 gap-12 w-full max-w-5xl">
            <div class="bg-white p-8 rounded-3xl border border-border shadow-xl hover:scale-105 transition-transform">
                <div class="text-5xl mb-6">üì¶</div>
                <h3 class="text-2xl font-bold text-primary mb-4">Tuplas como Claves</h3>
                <p class="text-gray-500 mb-6">Como son inmutables, las tuplas son perfectas para coordenadas compuesta.
                </p>
                <div class="bg-muted p-4 rounded-xl font-mono text-sm text-gray-700 border border-border">
                    <span class="text-purple-600">{</span><br>
                    &nbsp;&nbsp;<span class="text-action">(10, 20)</span>: <span class="text-green-600">"Punto
                        A"</span>,<br>
                    &nbsp;&nbsp;<span class="text-action">(30, 40)</span>: <span class="text-green-600">"Punto
                        B"</span><br>
                    <span class="text-purple-600">}</span>
                </div>
            </div>

            <div
                class="bg-white p-8 rounded-3xl border border-border shadow-xl hover:scale-105 transition-transform delay-100">
                <div class="text-5xl mb-6">üèóÔ∏è</div>
                <h3 class="text-2xl font-bold text-primary mb-4">Sets como Valores</h3>
                <p class="text-gray-500 mb-6">Ideal para almacenar colecciones √∫nicas dentro de una categor√≠a.</p>
                <div class="bg-muted p-4 rounded-xl font-mono text-sm text-gray-700 border border-border">
                    <span class="text-purple-600">{</span><br>
                    &nbsp;&nbsp;<span class="text-action">"tags"</span>: <span class="text-green-600">{ "py", "js",
                        "web" }</span><br>
                    <span class="text-purple-600">}</span>
                </div>
            </div>
        </div>

    </section>

    <!-- Slide 9: Resumen Final -->
    <section id="slide-9" class="slide hidden w-full h-full flex flex-col items-center justify-center p-12 text-center">
        <h2 class="text-4xl font-bold text-title mb-8">M√≥dulo 3: Diccionarios Finalizado</h2>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 w-full max-w-5xl">
            <!-- Column 1: Conceptos -->
            <div class="bg-white p-6 rounded-xl border border-border shadow-sm flex flex-col items-center">
                <div class="w-12 h-12 bg-accent/10 rounded-full flex items-center justify-center mb-4">
                    <svg class="w-6 h-6 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253">
                        </path>
                    </svg>
                </div>
                <h3 class="font-bold text-title mb-2">Conceptos Clave</h3>
                <ul class="text-sm text-body space-y-2 text-left w-full px-4">
                    <li class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-accent"></span>Pares
                        <strong>Clave-Valor</strong>
                    </li>
                    <li class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-accent"></span>Claves
                        <strong>√önicas</strong>
                    </li>
                    <li class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-accent"></span>Acceso por
                        <strong>Clave</strong>
                    </li>
                </ul>
            </div>

            <!-- Column 2: Logros -->
            <div
                class="bg-white p-6 rounded-xl border border-border shadow-sm flex flex-col items-center relative overflow-hidden">
                <div class="absolute top-0 w-full h-1 bg-gradient-to-r from-action to-action-hover"></div>
                <div class="w-12 h-12 bg-action/10 rounded-full flex items-center justify-center mb-4">
                    <svg class="w-6 h-6 text-action" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <h3 class="font-bold text-title mb-2">Ahora puedes...</h3>
                <ul class="text-sm text-body space-y-2 text-left w-full px-4">
                    <li class="flex items-center gap-2">‚úÖ Modelar objetos reales</li>
                    <li class="flex items-center gap-2">‚úÖ Realizar b√∫squedas r√°pidas</li>
                    <li class="flex items-center gap-2">‚úÖ Crear estructuras anidadas (JSON)</li>
                </ul>
            </div>

            <!-- Column 3: Cu√°ndo Usar -->
            <div class="bg-gray-50 p-6 rounded-xl border border-border dashed border-2 flex flex-col items-center">
                <div class="w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center mb-4">
                    <svg class="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <h3 class="font-bold text-gray-700 mb-2">¬øCu√°ndo NO usarlo?</h3>
                <p class="text-xs text-body mb-2 text-center">Si necesitas <strong>orden secuencial</strong> num√©rico
                    (usa listas).</p>
                <p class="text-xs text-body text-center">Si solo guardas valores <strong>sin etiquetas</strong> (usa
                    listas/sets).
                </p>
            </div>
        </div>

        <div class="mt-12">
            <p class="text-gray-400 text-sm mb-4">Has completado el M√≥dulo 3 de la Unidad 2</p>
            <button onclick="location.reload()"
                class="bg-white text-action hover:bg-gray-100 border border-border px-6 py-2 rounded-full text-sm font-medium transition-colors shadow-sm">
                Reiniciar M√≥dulo
            </button>
        </div>
    </section>

    <!-- Footer Navigation -->
    <footer class="h-20 bg-white border-t border-border shrink-0 flex items-center justify-between px-12 z-50 relative">
        <button onclick="changeSlide(-1)" id="btn-prev"
            class="p-3 rounded-xl hover:bg-muted transition-colors text-primary disabled:opacity-30 disabled:cursor-not-allowed">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="m15 18-6-6 6-6" />
            </svg>
        </button>

        <div class="flex items-center gap-4">
            <div class="flex gap-2" id="nav-dots">
                <!-- Dynamic Dots -->
            </div>
            <span id="slide-counter" class="text-sm font-mono font-bold text-action/60 min-w-[3rem] text-center">1 /
                8</span>
        </div>

        <button onclick="changeSlide(1)" id="btn-next"
            class="p-3 bg-primary text-white rounded-xl shadow-lg hover:bg-primary/90 transition-transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="m9 18 6-6-6-6" />
            </svg>
        </button>
    </footer>

    <script>
        // --- State Management ---
        let currentSlide = 0;
        const totalSlides = 9; // Updated to 9

        // --- Slide 2 Logic ---
        const defState = { "nombre": "Ana", "edad": 21 }; // Pre-populated data

        function renderDefVisuals() {
            const container = document.getElementById('def-cards-container');
            const empty = document.getElementById('def-empty-state');
            if (empty) empty.remove();

            // Clear current to rebuild safely or just appending? 
            // Better to clear and rebuild for simplicity in this specific constrained environment, 
            // or just ensure we don't duplicate.
            // Let's stick to the existing logic but make it callable.

            container.innerHTML = '';
            Object.entries(defState).forEach(([k, v]) => {
                const card = document.createElement('div');
                card.id = `def-card-${k}`;
                card.className = "bg-white p-3 rounded-lg border border-border flex justify-between items-center shadow-sm animate-[fadeIn_0.3s]";
                card.innerHTML = reformCard(k, v);
                container.appendChild(card);
            });

            // Update Code
            document.getElementById('def-code-display').textContent = "persona = " + JSON.stringify(defState, null, 4);
        }

        function addToDefinition() {
            const k = document.getElementById('def-key').value.trim();
            const v = document.getElementById('def-val').value.trim();
            if (!k || !v) return;

            defState[k] = isNaN(v) ? v : Number(v);
            renderDefVisuals();

            // Highlight specific card
            setTimeout(() => {
                const card = document.getElementById(`def-card-${k}`);
                if (card) {
                    card.classList.add('ring-2', 'ring-action');
                    setTimeout(() => card.classList.remove('ring-2', 'ring-action'), 300);
                }
            }, 50);

            // Clear inputs
            document.getElementById('def-key').value = '';
            document.getElementById('def-val').value = '';
        }

        function reformCard(k, v) {
            return `<span class="font-mono text-sm text-primary font-bold">"${k}"</span> <span class="text-gray-400">‚Üí</span> <span class="font-mono text-sm text-accent bg-accent/5 px-2 rounded">${JSON.stringify(v)}</span>`;
        }

        // --- Slide 3 Logic (Interactive) ---
        const slide3Content = {
            default: `
                <div class="bg-white p-6 rounded-xl border border-border shadow-sm h-full flex flex-col justify-center animate-[fadeIn:0.5s]">
                    <h3 class="text-xl font-bold text-center text-primary mb-8 underline decoration-action decoration-4 underline-offset-8">Analog√≠a: Agenda de contactos del celular</h3>
                    
                    <div class="flex gap-4 items-center">
                        <!-- List Analogy -->
                        <div class="flex-1 p-5 bg-gray-50 rounded-2xl border border-gray-200 flex flex-col items-center text-center h-full">
                            <div class="text-4xl mb-3">üìú</div>
                            <strong class="text-gray-700 block mb-2 font-black">Lista</strong>
                            <p class="text-[11px] text-gray-600 leading-relaxed">
                                Es como una lista de contactos ordenada por orden de agregado (o alfab√©ticamente). Para encontrar el tel√©fono de <b>"Mar√≠a"</b> tienes que bajar hasta la M ‚ûî <span class="text-red-500 font-bold">Lento si hay muchos</span>.
                            </p>
                        </div>

                        <div class="text-xl font-black text-gray-300 italic">VS</div>

                        <!-- Dictionary Analogy -->
                        <div class="flex-1 p-5 bg-action/5 rounded-2xl border border-action/20 flex flex-col items-center text-center h-full">
                            <div class="text-4xl mb-3">üì±</div>
                            <strong class="text-action block mb-2 font-black">Diccionario</strong>
                            <p class="text-[11px] text-gray-600 leading-relaxed">
                                Buscas directamente <b>"Mar√≠a"</b> en el buscador y aparece su n√∫mero (o foto, email, etc.) al instante ‚ûî <span class="text-green-600 font-bold">Sin importar si tienes 10 o 10.000</span>.
                            </p>
                        </div>
                    </div>
                </div>
            `,
            1: `
                <div class="bg-white p-8 rounded-xl border border-border shadow-sm h-full flex flex-col justify-center animate-[fadeIn_0.3s]">
                    <h3 class="text-xl font-bold text-primary mb-4 flex items-center gap-2">üìç No Posicional</h3>
                    <div class="bg-muted p-4 rounded-lg font-mono text-sm mb-4 border border-border">
                        <div class="text-gray-400"># En una lista (orden importa)</div>
                        <div>lista = ["A", "B", "C"]</div>
                        <div class="text-red-500">lista[0] ‚ûî "A"</div>
                        <br>
                        <div class="text-gray-400"># En un diccionario (clave importa)</div>
                        <div>datos = {"x": 10, "y": 20}</div>
                        <div class="text-green-500">datos["y"] ‚ûî 20</div>
                    </div>
                    <p class="text-gray-600">No importa d√≥nde est√© guardado el dato, lo encuentras por su nombre.</p>
                </div>
            `,
            2: `
                <div class="bg-white p-8 rounded-xl border border-border shadow-sm h-full flex flex-col justify-center animate-[fadeIn_0.3s]">
                    <h3 class="text-xl font-bold text-primary mb-4 flex items-center gap-2">üîë Claves √önicas</h3>
                    <div class="bg-muted p-4 rounded-lg font-mono text-sm mb-4 border border-border">
                        <div>persona = {</div>
                        <div class="pl-4">"id": 101,</div>
                        <div class="pl-4 text-red-500">"id": 999 <span class="text-gray-400"># Sobrescribe!</span></div>
                        <div>}</div>
                        <br>
                        <div class="text-blue-600">print(persona)</div>
                        <div class="text-green-600">‚ûî {"id": 999}</div>
                    </div>
                    <p class="text-gray-600">Es como una identificaci√≥n: no puede haber dos personas con el mismo DNI.</p>
                </div>
            `,
            3: `
                <div class="bg-white p-8 rounded-xl border border-border shadow-sm h-full flex flex-col justify-center animate-[fadeIn_0.3s]">
                    <h3 class="text-xl font-bold text-primary mb-4 flex items-center gap-2">üîÑ Mutable</h3>
                    <div class="bg-muted p-4 rounded-lg font-mono text-sm mb-4 border border-border">
                        <div>user = {"name": "Ana"}</div>
                        <br>
                        <div class="text-gray-400"># Modificar</div>
                        <div>user["name"] = "Maria"</div>
                        <br>
                        <div class="text-gray-400"># Agregar</div>
                        <div>user["age"] = 30</div>
                        <br>
                        <div class="text-green-600">‚ûî {"name": "Maria", "age": 30}</div>
                    </div>
                    <p class="text-gray-600">A diferencia de las tuplas, aqu√≠ puedes editar todo el tiempo.</p>
                </div>
            `,
            4: `
                <div class="bg-white p-8 rounded-xl border border-border shadow-sm h-full flex flex-col justify-center animate-[fadeIn_0.3s]">
                    <h3 class="text-xl font-bold text-primary mb-4 flex items-center gap-2">üì¶ Tipos Mixtos</h3>
                    <div class="bg-muted p-4 rounded-lg font-mono text-sm mb-4 border border-border">
                        <div>mochila = {</div>
                        <div class="pl-4"><span class="text-blue-500">"color"</span>: "rojo",</div>
                        <div class="pl-4"><span class="text-blue-500">"items"</span>: ["mapa", "agua"],</div>
                        <div class="pl-4"><span class="text-blue-500">"slots"</span>: 5</div>
                        <div>}</div>
                    </div>
                    <p class="text-gray-600">Combina textos, listas, n√∫meros e incluso otros diccionarios dentro.</p>
                </div>
            `
        };

        function selectProp3(id) {
            // Update Visual
            document.getElementById('slide3-right-panel').innerHTML = slide3Content[id];

            // Handle Styles
            [1, 2, 3, 4].forEach(i => {
                const btn = document.getElementById(`prop-btn-${i}`);
                if (i === id) {
                    btn.classList.add('bg-white', 'shadow-md', 'border-gray-100');
                    btn.classList.remove('border-transparent');
                } else {
                    btn.classList.remove('bg-white', 'shadow-md', 'border-gray-100');
                    btn.classList.add('border-transparent');
                }
            });
        }

        // --- Slide 4 Logic (Revised Tutorial) ---
        let libro = {};
        let slide4Visited = false;
        let tutorialActive = false;
        let tutStep = 0;
        let tutUserKey = ""; // Stores key from step 2

        function runSlide4Tutorial() {
            if (slide4Visited) return;
            resetTutorial();
        }

        function resetTutorial() {
            slide4Visited = true;
            tutorialActive = true;
            tutStep = 1;
            libro = {};
            document.getElementById('console-output-4').innerHTML = '<div class="text-gray-500 italic"># Consola interactiva de Python</div>';
            document.getElementById('console-input-4').value = "";
            document.getElementById('console-input-4').disabled = true;
            updateViz4();

            // Start Step 1
            showTutorialStep(1);
        }

        function showTutorialStep(step) {
            tutStep = step;
            const panel = document.getElementById('tutorial-panel');
            const output = document.getElementById('console-output-4');
            const input = document.getElementById('console-input-4');

            // Cleanup Styles
            ['step-create', 'step-add', 'step-access'].forEach(id => {
                document.getElementById(id).classList.remove('ring-4', 'ring-action', 'bg-white', 'shadow-lg', 'scale-105', 'z-10');
            });

            if (step === 1) { // Create
                const target = document.getElementById('step-create');
                positionPanel(panel, target);
                highlightCard(target);

                updatePanelText("Creando...", "Vamos a empezar creando un diccionario vac√≠o.");
                disableNextBtn(true);

                // Auto-type creation
                typeWriter("libro = {}", output, () => {
                    libro = {};
                    updateViz4();
                    disableNextBtn(false);
                });
            }
            else if (step === 2) { // Add
                const target = document.getElementById('step-add');
                positionPanel(panel, target);
                highlightCard(target);

                updatePanelText("¬°Te toca!", 'Agrega un elemento al diccionario. Por ejemplo: \nlibro["titulo"] = "El Quijote"');
                hideNextBtn(); // Must perform action

                input.disabled = false;
                input.focus();
                input.placeholder = 'ej: libro["titulo"] = "El Quijote"';
            }
            else if (step === 3) { // Access
                const target = document.getElementById('step-access');
                positionPanel(panel, target);
                highlightCard(target);

                updatePanelText("Verificando", `Ahora vamos a leer lo que guardaste en "${tutUserKey}".`);
                disableNextBtn(true);
                input.disabled = true;

                // Auto-type access
                typeWriter(`print(libro["${tutUserKey}"])`, output, () => {
                    const val = libro[tutUserKey];
                    output.innerHTML += `<div class="text-white mt-1 mb-2">${JSON.stringify(val)}</div>`;
                    output.scrollTop = output.scrollHeight;

                    // Highlight visualization
                    const vizItem = document.getElementById(`viz-item-${tutUserKey}`);
                    if (vizItem) vizItem.classList.add('bg-yellow-200', 'scale-110', 'transition-transform');

                    document.getElementById('tut-next-btn').textContent = "Finalizar";
                    document.getElementById('tut-next-btn').onclick = finishTutorial;
                    document.getElementById('tut-next-btn').classList.remove('hidden');
                    disableNextBtn(false);
                });
            }
        }

        function nextTutorialStep() {
            if (tutStep === 1) showTutorialStep(2);
            else if (tutStep === 2) return; // Automatic transition on success logic
            else if (tutStep === 3) finishTutorial();
        }

        function finishTutorial() {
            const panel = document.getElementById('tutorial-panel');
            panel.classList.add('opacity-0', 'pointer-events-none');
            document.getElementById('console-input-4').disabled = false;
            document.getElementById('console-input-4').focus();
            tutorialActive = false;

            // Reset styles
            ['step-create', 'step-add', 'step-access'].forEach(id => {
                document.getElementById(id).classList.remove('ring-4', 'ring-action', 'bg-white', 'shadow-lg', 'scale-105', 'z-10');
            });
        }

        // --- Helpers ---
        function highlightCard(el) {
            el.classList.add('ring-4', 'ring-action', 'bg-white', 'shadow-lg', 'scale-105', 'z-10');
        }

        function positionPanel(panel, target) {
            const rect = target.getBoundingClientRect();
            // Panel is inside .max-w-5xl.relative so we calculate based on that container
            const container = panel.parentElement;
            const containerRect = container.getBoundingClientRect();

            // Calculate relative position
            // Top: below the card + margin
            const top = rect.bottom - containerRect.top + 15;

            // Left: center relative to card vs container
            // (card center in container space) - (half panel width)
            const cardCenterX = rect.left - containerRect.left + (rect.width / 2);
            const panelWidth = 250; // Approximated fixed width from max-w-[250px]

            const left = cardCenterX - (panelWidth / 2);

            panel.style.top = `${top}px`;
            panel.style.left = `${left}px`;
            panel.classList.remove('opacity-0', 'pointer-events-none', 'translate-y-2');
        }

        function updatePanelText(title, desc) {
            document.getElementById('tut-title').textContent = title;
            document.getElementById('tut-desc').innerHTML = desc.replace(/\n/g, '<br>');
        }

        function disableNextBtn(disable) {
            const btn = document.getElementById('tut-next-btn');
            if (disable) {
                btn.classList.add('opacity-50', 'cursor-not-allowed');
                btn.disabled = true;
            } else {
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
                btn.disabled = false;
            }
        }

        function hideNextBtn() {
            document.getElementById('tut-next-btn').classList.add('hidden');
        }

        function typeWriter(text, container, callback) {
            container.innerHTML += `<div class="text-green-400 flex items-center gap-1">>>> <span id="typing-cursor"></span></div>`;
            const cursor = document.getElementById('typing-cursor');
            let i = 0;
            const speed = 80; // ms (m√°s lento como fue pedido)

            function type() {
                if (i < text.length) {
                    cursor.textContent += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                } else {
                    cursor.removeAttribute('id'); // Remove cursor hook
                    container.scrollTop = container.scrollHeight;
                    if (callback) callback();
                }
            }
            type();
        }

        function updateViz4() {
            const container = document.getElementById('dict-viz-4');
            if (Object.keys(libro).length === 0) {
                container.innerHTML = `
                    <span class="text-xs text-gray-400 font-bold uppercase tracking-widest mb-2 block">Memoria</span>
                    <div class="font-mono text-primary text-lg">{ }</div>`;
                return;
            }

            let html = `<span class="text-xs text-gray-400 font-bold uppercase tracking-widest mb-2 block">Memoria</span>
                        <div class="font-mono text-sm flex flex-col gap-1">`;
            for (let [k, v] of Object.entries(libro)) {
                html += `<div id="viz-item-${k}" class="bg-blue-50 px-2 py-1 rounded transition-all border border-blue-100 animate-[fadeIn_0.3s]">
                            <span class="text-primary font-bold">"${k}"</span>: <span class="text-accent">${JSON.stringify(v)}</span>
                         </div>`;
            }
            html += `</div>`;
            container.innerHTML = html;
        }

        function handleConsole4(e) {
            if (e.key === 'Enter') {
                const input = e.target;
                const cmd = input.value.trim();
                const output = document.getElementById('console-output-4');

                if (!cmd) return;

                output.innerHTML += `<div class="text-green-400">>>> ${cmd}</div>`;
                input.value = '';

                // --- Tutorial Validation Logic ---
                if (tutorialActive && tutStep === 2) {
                    // Check pattern: libro["clave"] = valor
                    const regex = /^libro\[["'](.+)["']\]\s*=\s*(.+)$/;
                    const match = cmd.match(regex);

                    if (!match) {
                        output.innerHTML += `<div class="text-red-400 mb-2">‚ö† Error: Usa el formato exacto: libro["clave"] = valor</div>`;
                        output.scrollTop = output.scrollHeight;
                        return;
                    }

                    const key = match[1];
                    let valStr = match[2];

                    // Parse Value
                    let val;
                    if ((valStr.startsWith('"') && valStr.endsWith('"')) || (valStr.startsWith("'") && valStr.endsWith("'"))) {
                        val = valStr.slice(1, -1);
                    } else if (!isNaN(Number(valStr))) {
                        val = Number(valStr);
                    } else {
                        output.innerHTML += `<div class="text-red-400 mb-2">‚ö† Error: El valor debe ser texto entre comillas o un n√∫mero.</div>`;
                        output.scrollTop = output.scrollHeight;
                        return;
                    }

                    // Success Step 2
                    libro[key] = val;
                    tutUserKey = key;
                    updateViz4();

                    output.innerHTML += `<div class="text-gray-500 italic mb-2"># ¬°Correcto! Guardado.</div>`;
                    output.scrollTop = output.scrollHeight;

                    showTutorialStep(3); // Auto advance to step 3
                    return;
                }

                // --- Normal Console Logic (Post-Tutorial) ---
                if (!tutorialActive) {
                    try {
                        if (cmd.startsWith('libro[') && cmd.includes('=')) {
                            // Assignment logic reuse... simpler regex for normal usage
                            const parts = cmd.split('=');
                            const left = parts[0].trim();
                            const right = parts.slice(1).join('=').trim();

                            const keyMatch = left.match(/\[["'](.+)["']\]/);
                            if (keyMatch) {
                                const key = keyMatch[1];
                                let val = right;
                                if ((val.startsWith('"') && val.endsWith('"')) || (val.startsWith("'") && val.endsWith("'"))) {
                                    val = val.slice(1, -1);
                                } else if (!isNaN(Number(val))) {
                                    val = Number(val);
                                }
                                libro[key] = val;
                                updateViz4();
                            }
                        } else if (cmd.startsWith('print(')) {
                            // Print logic
                            // print(libro["key"])
                            const match = cmd.match(/print\(libro\[["'](.+)["']\]\)/);
                            if (match) {
                                const key = match[1];
                                const val = libro[key];
                                output.innerHTML += `<div class="text-white mt-1 mb-2">${val !== undefined ? JSON.stringify(val) : 'None'}</div>`;
                            } else if (cmd === 'print(libro)') {
                                output.innerHTML += `<div class="text-white mt-1 mb-2">${JSON.stringify(libro)}</div>`;
                            }
                        }
                    } catch (err) {
                        output.innerHTML += `<div class="text-red-400">Error de sintaxis</div>`;
                    }
                }

                output.scrollTop = output.scrollHeight;
            }
        }

        // --- Slide 5 Logic ---
        let persona5 = { "nombre": "Error", "edad": 25, "error": "borrame", "extra": 10 };
        function initSlide5Visuals() {
            const container = document.getElementById('dict-viz-5');
            container.innerHTML = '';
            Object.entries(persona5).forEach(([k, v]) => {
                const div = document.createElement('div');
                div.className = "bg-white p-3 rounded-lg border border-border shadow-sm text-sm font-mono flex flex-col items-center min-w-[80px] transition-all duration-500";
                div.id = `card-5-${k}`;
                div.innerHTML = `<span class="text-green-600 font-bold">"${k}"</span><span class="text-gray-300">‚¨á</span><span class="text-blue-600">${JSON.stringify(v)}</span>`;
                container.appendChild(div);
            });
            checkMission();
        }

        // --- Slide 5 Logic (Unified with Slide 4 Tutorial style) ---
        let libro5 = { "titulo": "El Quijote", "autor": "Cervantes", "paginas": 800, "valor": "3 completos", "####": "3L1M!N4R" };
        let slide5Visited = false;
        let tutorialActive5 = false;
        let tutStep5 = 0;

        function runSlide5Tutorial() {
            if (slide5Visited) return;
            resetTutorial5();
        }

        function resetTutorial5() {
            slide5Visited = true;
            tutorialActive5 = true;
            tutStep5 = 1;
            libro5 = { "titulo": "El Quijote", "autor": "Cervantes", "paginas": 800, "valor": "3 completos", "####": "3L1M!N4R" };
            document.getElementById('console-output-5').innerHTML = '<div class="text-gray-500 italic"># Consola interactiva de Python</div>';
            document.getElementById('console-input-5').value = "";
            document.getElementById('console-input-5').disabled = true;
            updateViz5();
            showTutorialStep5(1);
        }

        function showTutorialStep5(step) {
            tutStep5 = step;
            const panel = document.getElementById('tutorial-panel-5');
            const output = document.getElementById('console-output-5');
            const input = document.getElementById('console-input-5');

            // Cleanup Styles
            ['step-mod', 'step-del', 'step-pop'].forEach(id => {
                document.getElementById(id).classList.remove('ring-4', 'ring-action', 'bg-white', 'shadow-lg', 'scale-105', 'z-10');
            });

            if (step === 1) { // Modificar
                const target = document.getElementById('step-mod');
                positionPanel(panel, target);
                highlightCard(target);
                updatePanelText5("Modificar", "Si usas una clave que ya existe, su valor se actualizar√°.");
                disableNextBtn5(true);

                typeWriter(`libro["paginas"] = 850`, output, () => {
                    libro5["paginas"] = 850;
                    updateViz5();
                    disableNextBtn5(false);
                });
            }
            else if (step === 2) { // Eliminar (del)
                const target = document.getElementById('step-del');
                positionPanel(panel, target);
                highlightCard(target);
                updatePanelText5("Tu turno", 'Usa "del" para borrar la clave incorrecta "error_data". Escribe: del libro["error_data"]');
                hideNextBtn5();
                input.disabled = false;
                input.focus();
            }
            else if (step === 3) { // Pop
                const target = document.getElementById('step-pop');
                positionPanel(panel, target);
                highlightCard(target);
                updatePanelText5("M√©todo pop()", 'Borra la clave "titulo" y devuelve su valor.');
                disableNextBtn5(true);

                typeWriter(`t = libro.pop("titulo")`, output, () => {
                    const val = libro5["titulo"];
                    delete libro5["titulo"];
                    updateViz5();
                    output.innerHTML += `<div class="text-white mt-1 mb-2">"El Quijote"</div>`;
                    document.getElementById('tut-next-btn-5').textContent = "Finalizar";
                    document.getElementById('tut-next-btn-5').onclick = finishTutorial5;
                    document.getElementById('tut-next-btn-5').classList.remove('hidden');
                    disableNextBtn5(false);
                });
            }
        }

        function nextTutorialStep5() {
            if (tutStep5 === 1) showTutorialStep5(2);
        }

        function finishTutorial5() {
            const panel = document.getElementById('tutorial-panel-5');
            panel.classList.add('opacity-0', 'pointer-events-none');
            document.getElementById('console-input-5').disabled = false;
            tutorialActive5 = false;
            ['step-mod', 'step-del', 'step-pop'].forEach(id => {
                document.getElementById(id).classList.remove('ring-4', 'ring-action', 'bg-white', 'shadow-lg', 'scale-105', 'z-10');
            });
        }

        function handleConsole5(e) {
            if (e.key === 'Enter') {
                const input = e.target;
                const cmd = input.value.trim();
                const output = document.getElementById('console-output-5');
                if (!cmd) return;

                output.innerHTML += `<div class="text-green-400">>>> ${cmd}</div>`;
                input.value = '';

                if (tutorialActive5 && tutStep5 === 2) {
                    if (cmd === 'del libro["error_data"]' || cmd === "del libro['error_data']") {
                        delete libro5["error_data"];
                        updateViz5();
                        output.innerHTML += `<div class="text-gray-500 italic mb-2"># ¬°Correcto! Eliminado.</div>`;
                        showTutorialStep5(3);
                    } else {
                        output.innerHTML += `<div class="text-red-400 mb-2">‚ö† Error: Escribe exactamente del libro["error_data"]</div>`;
                    }
                    output.scrollTop = output.scrollHeight;
                    return;
                }

                // Normal logic for Slide 5
                if (!tutorialActive5) {
                    try {
                        if (cmd.startsWith('del libro[')) {
                            const match = cmd.match(/del libro\[["'](.+)["']\]/);
                            if (match) { delete libro5[match[1]]; updateViz5(); }
                        } else if (cmd.includes('.pop(')) {
                            const match = cmd.match(/libro\.pop\(["'](.+)["']\)/);
                            if (match) {
                                const val = libro5[match[1]];
                                delete libro5[match[1]];
                                updateViz5();
                                output.innerHTML += `<div class="text-white">${val !== undefined ? JSON.stringify(val) : 'None'}</div>`;
                            }
                        } else if (cmd.startsWith('libro[')) {
                            const parts = cmd.split('=');
                            const kMatch = parts[0].match(/\[["'](.+)["']\]/);
                            if (kMatch) {
                                const key = kMatch[1];
                                let val = parts[1].trim();
                                if (val.startsWith('"') || val.startsWith("'")) val = val.slice(1, -1);
                                else if (!isNaN(Number(val))) val = Number(val);
                                libro5[key] = val;
                                updateViz5();
                            }
                        }
                    } catch (e) { output.innerHTML += `<div class="text-red-400">Error</div>`; }
                }
                output.scrollTop = output.scrollHeight;
            }
        }

        function updateViz5() {
            const container = document.getElementById('dict-viz-5');
            let html = `<span class="text-xs text-gray-400 font-bold uppercase tracking-widest mb-2 block">Memoria</span>
                        <div class="font-mono text-sm flex flex-col gap-1 w-full min-w-[150px]">`;
            for (let [k, v] of Object.entries(libro5)) {
                html += `<div class="bg-blue-50 px-2 py-1 rounded border border-blue-100 flex justify-between gap-8 animate-[fadeIn_0.3s]">
                            <span class="text-primary font-bold min-w-[60px]">"${k}"</span> <span class="text-accent text-right flex-1">${JSON.stringify(v)}</span>
                         </div>`;
            }
            if (Object.keys(libro5).length === 0) html += `<div class="text-primary">{ }</div>`;
            html += `</div>`;
            container.innerHTML = html;
        }

        function updatePanelText5(title, desc) {
            document.getElementById('tut-title-5').textContent = title;
            document.getElementById('tut-desc-5').innerHTML = desc.replace(/\n/g, '<br>');
        }
        function disableNextBtn5(disable) {
            const btn = document.getElementById('tut-next-btn-5');
            btn.disabled = disable;
            btn.classList.toggle('opacity-50', disable);
        }
        function hideNextBtn5() { document.getElementById('tut-next-btn-5').classList.add('hidden'); }

        // --- Slide 6 Logic ---
        const libro6Data = { "id": 101, "rol": "admin", "active": true };
        const vizItems6 = [
            { k: '"id"', v: '101' },
            { k: '"rol"', v: '"admin"' },
            { k: '"active"', v: 'True' }
        ];
        let currentLoop = 'keys';

        function initSlide6() {
            const container = document.getElementById('loop-viz-container');
            container.innerHTML = vizItems6.map(item => `
                <div class="loop-item p-3 bg-white border border-border rounded-lg flex justify-between opacity-50 transition-all">
                    <span class="font-bold text-primary">${item.k}</span>
                    <span class="text-gray-400">${item.v}</span>
                </div>
            `).join('');
            setLoopMode('keys');
        }

        function setLoopMode(mode) {
            currentLoop = mode;
            // Reset styles
            ['keys', 'values', 'items'].forEach(m => document.getElementById(`btn-${m}`).classList.remove('bg-action', 'text-white'));
            document.getElementById(`btn-${mode}`).classList.add('bg-action', 'text-white');

            // Content
            const texts = {
                keys: { title: "Recorrer Claves (.keys)", desc: "Itera solo por las etiquetas. Es lo que ocurre por defecto en un for x in dict.", code: "libro.keys()", var: "k" },
                values: { title: "Recorrer Valores (.values)", desc: "Itera solo por el contenido, ignorando las etiquetas.", code: "libro.values()", var: "v" },
                items: { title: "Recorrer Items (.items)", desc: "Entrega tuplas (clave, valor). Es el m√°s completo.", code: "libro.items()", var: "k, v" }
            };

            document.getElementById('loop-title').textContent = texts[mode].title;
            document.getElementById('loop-desc').textContent = texts[mode].desc;
            document.getElementById('loop-source').textContent = texts[mode].code;
            document.getElementById('loop-var').textContent = texts[mode].var;
            document.getElementById('loop-print').textContent = texts[mode].var;
        }

        function runLoopAnim() {
            const container = document.getElementById('loop-viz-container');
            const nodes = container.children;
            const highlight = document.getElementById('loop-code-highlight');
            const consoleOutput = document.getElementById('console-output-6');

            // Reset Console
            consoleOutput.innerHTML = '';

            // Animation Sequence
            highlight.style.transform = 'translateY(24px)'; // Move to for line

            let i = 0;
            const interval = setInterval(() => {
                if (i >= nodes.length) {
                    clearInterval(interval);
                    highlight.style.transform = 'translateY(8px)';
                    Array.from(nodes).forEach(n => n.style.opacity = '0.5');
                    return;
                }

                // Reset
                Array.from(nodes).forEach(n => { n.style.opacity = '0.5'; n.classList.remove('scale-105', 'border-action'); });

                // Highlight Current
                const curr = nodes[i];
                curr.style.opacity = '1';
                curr.classList.add('scale-105', 'border-action');

                // Highlight part
                const keySpan = curr.querySelector('span:first-child');
                const valSpan = curr.querySelector('span:last-child');

                if (currentLoop === 'keys') { keySpan.style.color = '#0055ad'; }
                else if (currentLoop === 'values') { valSpan.style.color = '#0055ad'; }
                else { keySpan.style.color = '#0055ad'; valSpan.style.color = '#0055ad'; }

                setTimeout(() => {
                    keySpan.style.color = '';
                    valSpan.style.color = '';
                }, 800);

                highlight.style.transform = 'translateY(48px)'; // Print line

                // Add to console
                const capturedItem = vizItems6[i];
                setTimeout(() => {
                    let text = "";
                    if (currentLoop === 'keys') text = capturedItem.k;
                    else if (currentLoop === 'values') text = capturedItem.v;
                    else text = `(${capturedItem.k}, ${capturedItem.v})`;

                    consoleOutput.innerHTML += `<div class="text-white animate-[fadeIn_0.5s] border-l-2 border-action/30 pl-2 mb-1">${text}</div>`;
                    consoleOutput.scrollTop = consoleOutput.scrollHeight;
                }, 400);

                setTimeout(() => highlight.style.transform = 'translateY(24px)', 400); // Back to loop

                i++;
            }, 1000);
        }

        // --- Slide 7 Logic (Tree) ---
        const treeData = {
            "estudiante": {
                "nombre": "Pedro",
                "edad": 18,
                "carrera": "Ingenier√≠a Civil Inform√°tica",
                "notas": {
                    "matematicas": 6.5,
                    "programacion": 7.0,
                    "fisica": 5.8
                },
                "direccion": {
                    "calle": "Av. Libertador 123",
                    "ciudad": "Santiago",
                    "region": {
                        "nombre": "Metropolitana",
                        "codigo": "RM"
                    }
                }
            }
        };

        function renderTree(obj, container) {
            Object.entries(obj).forEach(([k, v]) => {
                const line = document.createElement('div');
                line.className = "mb-2";

                if (typeof v === 'object' && v !== null) {
                    line.innerHTML = `<span class="text-purple-600 font-bold">"${k}"</span>: <span class="text-gray-400">{</span>`;
                    container.appendChild(line);

                    const childrenContainer = document.createElement('div');
                    childrenContainer.className = "tree-line";
                    container.appendChild(childrenContainer);
                    renderTree(v, childrenContainer);

                    const close = document.createElement('div');
                    close.innerHTML = `<span class="text-gray-400">}</span>`;
                    container.appendChild(close);
                } else {
                    line.innerHTML = `<span class="text-primary font-bold">"${k}"</span>: <span class="text-green-600">"${v}"</span>`;
                    container.appendChild(line);
                }
            });
        }

        // --- Navigation Core ---
        function init() {
            // Render Dots
            const dots = document.getElementById('nav-dots');
            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('div');
                dot.className = `w-3 h-3 rounded-full transition-all duration-300 ${i === 0 ? 'bg-primary scale-110' : 'bg-gray-300'}`;
                dots.appendChild(dot);
            }
            updateSlideView();
            renderDefVisuals(); // Init Slide 2 visuals
            selectProp3('default'); // Init Slide 3 default
            updateViz5();
            updateViz5();
            initSlide6();
        }

        function changeSlide(dir) {
            currentSlide += dir;
            if (currentSlide < 0) currentSlide = 0;
            if (currentSlide >= totalSlides) currentSlide = totalSlides - 1;
            updateSlideView();

            // Trigger Side Effects
            if (currentSlide === 3) { // Slide 4 (0-indexed) is 3
                setTimeout(runSlide4Tutorial, 500);
            }
            if (currentSlide === 4) { // Slide 5
                setTimeout(runSlide5Tutorial, 500);
            }
        }

        function updateSlideView() {
            // Visibility
            document.querySelectorAll('.slide').forEach((s, idx) => {
                if (idx === currentSlide) s.classList.add('active');
                else s.classList.remove('active');
            });

            // Buttons
            document.getElementById('btn-prev').disabled = currentSlide === 0;
            document.getElementById('btn-next').disabled = currentSlide === totalSlides - 1;

            // Dots
            const navDots = document.getElementById('nav-dots').children;
            Array.from(navDots).forEach((d, idx) => {
                d.className = `w-3 h-3 rounded-full transition-all duration-300 ${idx === currentSlide ? 'bg-primary scale-110 shadow-md' : 'bg-gray-300'}`;
            });

            // Update Counter
            document.getElementById('slide-counter').textContent = `${currentSlide + 1} / ${totalSlides}`;
        }

        // Init
        document.addEventListener('DOMContentLoaded', init);

        // Keyboard Support
        window.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') changeSlide(1);
            if (e.key === 'ArrowLeft') changeSlide(-1);
        });

    </script>
</body>

</html>